<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>JWT Security Report - ES256 Token</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
 body { font-family: Arial, sans-serif; margin: 20px; background:#f8f9fb; color:#222; }
 h1,h2,h3 { color:#222; }
 code { background:#eee; padding:2px 4px; border-radius:4px; }
 pre { background:#272822; color:#f8f8f2; padding:12px; overflow:auto; border-radius:6px; }
 .grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap:16px; }
 .card { background:#fff; border:1px solid #ddd; border-radius:8px; padding:14px; box-shadow:0 1px 2px rgba(0,0,0,0.06); }
 .severity { font-weight:bold; padding:2px 6px; border-radius:4px; font-size:12px; }
 .sev-low { background:#d1e7dd; color:#0f5132; }
 .sev-med { background:#fff3cd; color:#664d03; }
 .sev-high { background:#f8d7da; color:#842029; }
 table { width:100%; border-collapse:collapse; margin:16px 0; }
 th,td { padding:6px 8px; border-bottom:1px solid #e5e5e5; text-align:left; vertical-align:top; }
 th { background:#f0f2f5; }
 .badge { display:inline-block; padding:2px 6px; font-size:11px; background:#e0e7ff; color:#1e3a8a; border-radius:4px; margin-right:4px; }
 .ok { color:#0f5132; }
 .warn { color:#664d03; }
 .fail { color:#842029; }
 .summary-box { background:#fff; border:1px solid #cfe2ff; padding:12px; border-left:6px solid #0d6efd; border-radius:6px; }
 footer { margin-top:40px; font-size:12px; color:#555; }
 .mono { font-family: SFMono-Regular, Menlo, Consolas, monospace; font-size:13px; }
</style>
</head>
<body>
<h1>JWT Security Report (ES256)</h1>
<p>Generated: <strong><script>document.write(new Date().toISOString())</script></strong></p>

<h2>1. Token Provided</h2>
<pre class="mono">eyJhbGciOiJFUzI1NiJ9.eyJ1bmlxdWUiOiJjYWJlYWUyOS0wMzI3LTQzMjgtOTMwNC02OWUyYjVhYmU1YjQiLCJ1c2VyVHlwZSI6IlJJTHBlcnNvbiIsImF1dGhMZXZlbCI6IjIwIiwiZGV2aWNlSWQiOiIxYTMxZTg1NTIyOTVhOWNmZTRlZWIwYWI5ZWM4MTkzMzEzNTQwZmE3MWViOTEwZTFjN2IzNTcyOGYxYjU3ZTJjNTc0YjQxM2I4YjJlZTVmYWI5M2YwMTE0N2M4YWMwOGQ5ZTAzYmVhZmRkNTlmYWIyMWIzNzJiMWZjNmI4Yzc5MSIsInJlYWxtIjoibm9uLWppbyIsImlhdCI6MTc1NjQ2NTAxMn0.P0ROYdJwWA2kfDX4Vj6URWPTQgaaVCNHoiY8GmnZS25gEKImUDh1ZtXrlSvN6045p2oPpK2LPwSjwtmJ3ish-w</pre>

<h2>2. Decoded Structure</h2>
<h3>Header</h3>
<pre class="mono">{
  "alg": "ES256"
}</pre>
<h3>Payload</h3>
<pre class="mono">{
  "unique": "cabeae29-0327-4328-9304-69e2b5abe5b4",
  "userType": "RILperson",
  "authLevel": "20",
  "deviceId": "1a31e8552295a9cfe4eeb0ab9ec8193313540fa71eb910e1c7b35728f1b57e2c574b413b8b2ee5fab93f01147c8ac08d9e03beafdd59fab21b372b1fc6b8c791",
  "realm": "non-jio",
  "iat": 1756465012
}</pre>

<h2>3. Claims Evaluation</h2>
<table>
<tr><th>Claim</th><th>Status</th><th>Observation</th><th>Risk</th></tr>
<tr><td>iat</td><td class="ok">Present</td><td>Issued-at provided.</td><td><span class="severity sev-low">Low</span></td></tr>
<tr><td>exp</td><td class="fail">Missing</td><td>No expiration -> token may live indefinitely.</td><td><span class="severity sev-high">High</span></td></tr>
<tr><td>nbf</td><td class="fail">Missing</td><td>No not-before guard.</td><td><span class="severity sev-med">Medium</span></td></tr>
<tr><td>jti</td><td class="fail">Missing</td><td>No unique revocation handle.</td><td><span class="severity sev-med">Medium</span></td></tr>
<tr><td>aud</td><td class="fail">Missing</td><td>No audience restriction.</td><td><span class="severity sev-med">Medium</span></td></tr>
<tr><td>iss</td><td class="fail">Missing</td><td>No issuer specified.</td><td><span class="severity sev-med">Medium</span></td></tr>
<tr><td>sub</td><td class="fail">Missing</td><td>Subject not defined.</td><td><span class="severity sev-low">Low</span></td></tr>
<tr><td>kid (header)</td><td class="fail">Missing</td><td>No key id -> hampers rotation / introspection.</td><td><span class="severity sev-low">Low</span></td></tr>
</table>

<h2>4. Algorithm & Cryptography Assessment</h2>
<ul>
  <li><strong>Algorithm:</strong> ES256 (P-256 + SHA-256) – modern and acceptable.</li>
  <li><strong>Positive:</strong> Asymmetric algorithm reduces shared secret exposure.</li>
  <li><strong>Concerns:</strong> No <code>kid</code> prevents efficient key rollover; signature cannot be validated here without public key.</li>
  <li><strong>Recommendation:</strong> Publish a JWKS endpoint with rotating keys and include <code>kid</code>.</li>
</ul>

<h2>5. Risk Summary</h2>
<div class="grid">
  <div class="card"><h3>Missing exp</h3><p>Token could persist indefinitely if accepted by relying services.</p><p><span class="severity sev-high">High</span></p></div>
  <div class="card"><h3>No jti</h3><p>Hard to revoke individually.</p><p><span class="severity sev-med">Medium</span></p></div>
  <div class="card"><h3>No aud / iss</h3><p>Context-free token can be replayed across services.</p><p><span class="severity sev-med">Medium</span></p></div>
  <div class="card"><h3>No kid</h3><p>Key rotation / incident response slowed.</p><p><span class="severity sev-low">Low</span></p></div>
  <div class="card"><h3>nbf missing</h3><p>No enforced earliest validity time.</p><p><span class="severity sev-med">Medium</span></p></div>
</div>

<h2>6. Prioritized Recommendations</h2>
<ol>
  <li>Add <code>exp</code> (short TTL, e.g. 5–15 min) and enforce refresh via separate channel.</li>
  <li>Include <code>jti</code> and maintain a revocation/deny list store (e.g. Redis) for compromised tokens.</li>
  <li>Add contextual claims: <code>iss</code>, <code>aud</code>, and optionally <code>sub</code> describing principal.</li>
  <li>Add <code>nbf</code> to prevent premature use; align with <code>iat</code>.</li>
  <li>Introduce <code>kid</code> and publish a JWKS document; automate rotation every 60–90 days.</li>
  <li>Log only token fingerprint (hash of header.payload) – never full token.</li>
</ol>

<h2>7. Suggested Hardening Controls</h2>
<ul>
  <li>Gateway enforcement: reject tokens missing <code>exp</code>, <code>aud</code>, <code>iss</code>.</li>
  <li>Implement sliding session via refresh token or OAuth2 flow.</li>
  <li>Enforce algorithm allowlist: ES256 only; reject unexpected values.</li>
  <li>Add anomaly detection: alert on unusually old <code>iat</code> values.</li>
  <li>Apply structured logging: hash(token) + jti + subject (when added).</li>
</ul>

<h2>8. CVSS-Style Approx Scoring</h2>
<table>
<tr><th>Issue</th><th>Vector (Simplified)</th><th>Score (Est.)</th><th>Severity</th></tr>
<tr><td>Missing exp</td><td>AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:M/A:L</td><td>8.2</td><td><span class="severity sev-high">High</span></td></tr>
<tr><td>No audience</td><td>AV:N/AC:L/PR:N/UI:N/S:U/C:M/I:M/A:N</td><td>7.1</td><td><span class="severity sev-med">Medium</span></td></tr>
<tr><td>No jti</td><td>AV:N/AC:L/PR:N/UI:N/S:U/C:M/I:L/A:N</td><td>6.5</td><td><span class="severity sev-med">Medium</span></td></tr>
<tr><td>No kid</td><td>AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N</td><td>4.3</td><td><span class="severity sev-low">Low</span></td></tr>
</table>
<p><strong>Overall Posture:</strong> Medium risk – primarily due to absent expiry and contextual claims.</p>

<h2>9. Machine-Readable Summary</h2>
<pre class="mono">{
  "alg": "ES256",
  "present_claims": ["iat", "unique", "userType", "authLevel", "deviceId", "realm"],
  "missing_standard_claims": ["exp", "nbf", "jti", "aud", "iss", "sub"],
  "missing_header_fields": ["kid"],
  "risk_rating": "Medium",
  "high_risk": ["missing exp"],
  "recommendations_count": 6
}</pre>

<footer>
  <p>Generated by Enhanced JWT Tool Security Analyzer (ES256 focus). Educational & Commercial Dual-License.</p>
</footer>
</body>
</html>