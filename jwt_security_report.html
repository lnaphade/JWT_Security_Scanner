<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT Security Scan Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #343a40;
            color: white;
            padding: 20px 0;
            border-radius: 5px 5px 0 0;
            margin-bottom: 30px;
        }
        header .container {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
        }
        .report-date {
            font-size: 14px;
            opacity: 0.8;
        }
        .report-card {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            overflow: hidden;
        }
        .report-header {
            background-color: #f0f0f0;
            padding: 15px 20px;
            border-bottom: 1px solid #e0e0e0;
            font-weight: bold;
        }
        .report-body {
            padding: 20px;
        }
        .report-footer {
            background-color: #f0f0f0;
            padding: 15px 20px;
            border-top: 1px solid #e0e0e0;
            font-size: 0.9em;
            color: #666;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #e0e0e0;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
        }
        th {
            background-color: #f0f0f0;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .token-section {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-family: monospace;
            word-break: break-all;
        }
        .issue {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        .issue-title {
            font-weight: bold;
            color: #dc3545;
            margin-bottom: 5px;
            font-size: 1.1em;
        }
        .warning-title {
            font-weight: bold;
            color: #ffc107;
            margin-bottom: 5px;
            font-size: 1.1em;
        }
        .issue-description {
            color: #555;
            margin-bottom: 10px;
        }
        .severity-high {
            background-color: #dc3545;
            color: white;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8em;
        }
        .severity-medium {
            background-color: #ffc107;
            color: #333;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8em;
        }
        .severity-low {
            background-color: #17a2b8;
            color: white;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8em;
        }
        .severity-info {
            background-color: #007bff;
            color: white;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8em;
        }
        .summary-box {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .summary-item {
            flex: 1;
            padding: 15px;
            margin: 0 5px;
            text-align: center;
            border-radius: 5px;
        }
        .summary-item.issues {
            background-color: #fff3f3;
            border-left: 5px solid #dc3545;
        }
        .summary-item.warnings {
            background-color: #fff9e6;
            border-left: 5px solid #ffc107;
        }
        .summary-item.passed {
            background-color: #e6fff2;
            border-left: 5px solid #28a745;
        }
        .summary-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .recommendations {
            background-color: #e6f7ff;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        .recommendations h3 {
            color: #0066cc;
            margin-top: 0;
        }
        .code-block {
            background-color: #343a40;
            color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
        }
        .risk-box {
            border-left: 4px solid #dc3545;
            background-color: #fff8f8;
            padding: 10px 15px;
            margin: 10px 0;
        }
        .risk-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        .risk-section {
            margin-bottom: 8px;
        }
        .risk-section-title {
            font-weight: bold;
            margin-right: 5px;
        }
        .diagram {
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .technical-notes {
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #007bff;
        }
        .technical-notes pre {
            background-color: #333;
            color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .risk-mitigation {
            background-color: #f0fff0;
            padding: 10px 15px;
            border-radius: 5px;
            margin-top: 10px;
            border-left: 4px solid #28a745;
        }
        .risk-impact {
            background-color: #fff4e6;
            padding: 10px 15px;
            border-radius: 5px;
            margin-top: 10px;
            border-left: 4px solid #fd7e14;
        }
        .tabs {
            display: flex;
            margin-bottom: -1px;
        }
        .tab {
            padding: 10px 15px;
            cursor: pointer;
            background-color: #f0f0f0;
            border: 1px solid #e0e0e0;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        .tab.active {
            background-color: white;
            border-bottom: 1px solid white;
        }
        .tab-content {
            display: none;
            border: 1px solid #e0e0e0;
            padding: 15px;
            background-color: white;
        }
        .tab-content.active {
            display: block;
        }
        .section-title {
            color: #007bff;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
            margin: 25px 0 15px;
        }
        .alert-box {
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border-left: 5px solid;
        }
        .alert-info {
            background-color: #e6f7ff;
            border-left-color: #1890ff;
        }
        .alert-warning {
            background-color: #fffbe6;
            border-left-color: #faad14;
        }
        .alert-danger {
            background-color: #fff2f0;
            border-left-color: #ff4d4f;
        }
        .alert-success {
            background-color: #f6ffed;
            border-left-color: #52c41a;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab functionality
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetId = this.dataset.target;
                    
                    // Hide all tab contents
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Deactivate all tabs
                    tabs.forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    // Activate clicked tab and content
                    this.classList.add('active');
                    document.getElementById(targetId).classList.add('active');
                });
            });
        });
    </script>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">JWT Tool Security Scan Report</div>
            <div class="report-date">Report Generated: August 29, 2025</div>
        </div>
    </header>
    
    <div class="container">
        <div class="report-card">
            <div class="report-header">Executive Summary</div>
            <div class="report-body">
                <p>This security report analyzes the provided ES256 JSON Web Token (JWT) for potential security vulnerabilities and best practices compliance. The scan was performed using JWT Tool version 2.0.0 with ES256 support enabled.</p>
                
                <div class="summary-box">
                    <div class="summary-item issues">
                        <div class="summary-number">0</div>
                        <div>Critical Issues</div>
                    </div>
                    <div class="summary-item warnings">
                        <div class="summary-number">3</div>
                        <div>Security Warnings</div>
                    </div>
                    <div class="summary-item passed">
                        <div class="summary-number">1</div>
                        <div>Passed Checks</div>
                    </div>
                </div>
                
                <p><strong>Token Overview:</strong> The analyzed token uses ES256 (ECDSA with SHA-256) for signature verification, which is a secure algorithm when properly implemented. The token contains user identity information and authorization data but lacks several security-enhancing claims.</p>
            </div>
        </div>
        
        <div class="report-card">
            <div class="report-header">Token Details</div>
            <div class="report-body">
                <div class="token-section">eyJhbGciOiJFUzI1NiJ9.eyJ1bmlxdWUiOiJjYWJlYWUyOS0wMzI3LTQzMjgtOTMwNC02OWUyYjVhYmU1YjQiLCJ1c2VyVHlwZSI6IlJJTHBlcnNvbiIsImF1dGhMZXZlbCI6IjIwIiwiZGV2aWNlSWQiOiIxYTMxZTg1NTIyOTVhOWNmZTRlZWIwYWI5ZWM4MTkzMzEzNTQwZmE3MWViOTEwZTFjN2IzNTcyOGYxYjU3ZTJjNTc0YjQxM2I4YjJlZTVmYWI5M2YwMTE0N2M4YWMwOGQ5ZTAzYmVhZmRkNTlmYWIyMWIzNzJiMWZjNmI4Yzc5MSIsInJlYWxtIjoibm9uLWppbyIsImlhdCI6MTc1NjQ2NTAxMn0.P0ROYdJwWA2kfDX4Vj6URWPTQgaaVCNHoiY8GmnZS25gEKImUDh1ZtXrlSvN6045p2oPpK2LPwSjwtmJ3ish-w</div>
                
                <h3>Header Claims</h3>
                <table>
                    <tr>
                        <th>Claim</th>
                        <th>Value</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>alg</td>
                        <td>ES256</td>
                        <td>ECDSA signature with SHA-256</td>
                    </tr>
                </table>
                
                <h3>Payload Claims</h3>
                <table>
                    <tr>
                        <th>Claim</th>
                        <th>Value</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>unique</td>
                        <td>cabeae29-0327-4328-9304-69e2b5abe5b4</td>
                        <td>Unique identifier (UUID format)</td>
                    </tr>
                    <tr>
                        <td>userType</td>
                        <td>RILperson</td>
                        <td>Type of user account</td>
                    </tr>
                    <tr>
                        <td>authLevel</td>
                        <td>20</td>
                        <td>Authorization level</td>
                    </tr>
                    <tr>
                        <td>deviceId</td>
                        <td>1a31e855...fc6b8c791</td>
                        <td>Device identifier (truncated for display)</td>
                    </tr>
                    <tr>
                        <td>realm</td>
                        <td>non-jio</td>
                        <td>Authentication realm</td>
                    </tr>
                    <tr>
                        <td>iat</td>
                        <td>1756465012</td>
                        <td>Issued at: August 29, 2025 16:26:52 (UTC)</td>
                    </tr>
                </table>
                
                <h3>Signature</h3>
                <p>The token is signed using ES256 (ECDSA with P-256 and SHA-256). The signature appears to be properly formatted for this algorithm type.</p>
            </div>
        </div>
        
        <div class="report-card">
            <div class="report-header">Security Findings</div>
            <div class="report-body">
                <div class="issue">
                    <div class="warning-title"><span class="severity-medium">WARNING</span> Missing Expiration Claim</div>
                    <div class="issue-description">
                        <p>The token does not include an <code>exp</code> (expiration time) claim. Without an expiration time, the token remains valid indefinitely, which increases the security risk if the token is compromised.</p>
                        <p><strong>Impact:</strong> Stolen tokens can be used indefinitely, increasing the potential damage from token theft.</p>
                    </div>
                </div>
                
                <div class="issue">
                    <div class="warning-title"><span class="severity-medium">WARNING</span> Missing JWT ID Claim</div>
                    <div class="issue-description">
                        <p>The token does not include a <code>jti</code> (JWT ID) claim. This claim provides a unique identifier for the token and enables token revocation.</p>
                        <p><strong>Impact:</strong> Without a JWT ID, it's more difficult to implement token revocation mechanisms, which are important for handling compromised tokens.</p>
                    </div>
                </div>
                
                <div class="issue">
                    <div class="warning-title"><span class="severity-low">WARNING</span> Missing Key ID in Header</div>
                    <div class="issue-description">
                        <p>The token header does not include a <code>kid</code> (Key ID) parameter. The Key ID helps identify which key was used to sign the token, which is important in systems that use multiple signing keys.</p>
                        <p><strong>Impact:</strong> Without a Key ID, key rotation and management become more challenging, especially in systems with multiple signing keys.</p>
                    </div>
                </div>
                
                <div class="issue">
                    <div class="warning-title"><span class="severity-low">INFO</span> ES256 Algorithm Implementation</div>
                    <div class="issue-description">
                        <p>The token uses the ES256 algorithm which is correctly implemented using the pycryptodomex library in JWT Tool. This is a secure signature algorithm when properly implemented.</p>
                        <p><strong>Impact:</strong> Positive security impact. ECDSA signatures provide good security with smaller key sizes compared to RSA.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="report-card">
            <div class="report-header">Recommendations</div>
            <div class="report-body">
                <div class="recommendations">
                    <h3>Security Improvement Recommendations</h3>
                    <ol>
                        <li><strong>Add Expiration Claim:</strong> Include an <code>exp</code> claim with a reasonable expiration time to limit the token's validity period.</li>
                        <li><strong>Implement JWT ID:</strong> Add a <code>jti</code> claim with a unique identifier to enable token revocation capabilities.</li>
                        <li><strong>Add Key ID:</strong> Include a <code>kid</code> parameter in the header to facilitate key rotation and proper key management.</li>
                        <li><strong>Consider Additional Standard Claims:</strong> Add <code>nbf</code> (not before) and <code>aud</code> (audience) claims to further enhance security.</li>
                        <li><strong>Implement Token Refresh Strategy:</strong> Use short-lived tokens with a refresh token mechanism rather than long-lived tokens.</li>
                    </ol>
                </div>
                
                <h3>Example of an Improved Token</h3>
                <p>A more secure token would include additional security claims:</p>
                <div class="code-block">
// Header
{
  "alg": "ES256",
  "typ": "JWT",
  "kid": "key-id-12345"
}

// Payload
{
  "unique": "cabeae29-0327-4328-9304-69e2b5abe5b4",
  "userType": "RILperson",
  "authLevel": "20",
  "deviceId": "1a31e855...",
  "realm": "non-jio",
  "iat": 1756465012,
  "exp": 1756468612,  // +1 hour from issuance
  "nbf": 1756464952,  // -1 minute from issuance
  "jti": "unique-token-id-7890",
  "aud": "https://api.example.com"
}
                </div>
            </div>
        </div>
        
        <div class="report-card">
            <div class="report-header">JWT Tool Information</div>
            <div class="report-body">
                <p>This security scan was performed using JWT Tool version 2.0.0 with ES256 support enabled via the pycryptodomex library.</p>
                <p>The ES256 algorithm implementation was successfully validated as part of the recent enhancement to add ECDSA signature support to the tool.</p>
                
                <h3>Scan Parameters</h3>
                <table>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                    </tr>
                    <tr>
                        <td>Scan Date</td>
                        <td>August 29, 2025</td>
                    </tr>
                    <tr>
                        <td>JWT Tool Version</td>
                        <td>2.0.0</td>
                    </tr>
                    <tr>
                        <td>Scan Type</td>
                        <td>Local token analysis</td>
                    </tr>
                    <tr>
                        <td>Vulnerabilities Checked</td>
                        <td>Missing claims, algorithm verification, expiration, token structure</td>
                    </tr>
                </table>
            </div>
            <div class="report-footer">
                Generated by JWT Tool - Custom JWT Security Analysis Tool
            </div>
        </div>
    </div>
</body>
</html>